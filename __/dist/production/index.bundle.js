!function(t,e){for(var n in e)t[n]=e[n]}(this,function(t){var e={};function n(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(s,r,function(e){return t[e]}.bind(null,r));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}([function(t,e){!function(){t.exports=this.React}()},function(t,e,n){var s=znui.React||n(0),r=s.createClass({displayName:"FormItem",getDefaultProps:function(){return{submitted:!0,disabled:!1,required:!1,hint:null}},getInitialState:function(){return{status:"default",value:this.props.value,text:this.props.text,errorMessage:null}},componentWillUnmount:function(){this._timeout&&window.clearTimeout(this._timeout)},setValue:function(t,e){this.setState({value:t,text:e})},getValue:function(t){return this.state.value},validate:function(t){var e=this.state.value,n=this.props.error||"数据验证错误";return!this.props.required||""!==e&&null!=e?!1===(t&&t(e,this))?(this.setState({status:"error",errorMessage:n}),void(this.props.onValidateError&&this.props.onValidateError(n,this))):(this.setState({status:"success",errorMessage:null}),this.props.onValidateSuccess&&this.props.onValidateSuccess(this),this._timeout=window.setTimeout(function(){this.__isMounted&&this.setState&&this.setState({status:"default"})}.bind(this),1e3),e):(this.setState({status:"error",errorMessage:n}),void(this.props.onValidateError&&this.props.onValidateError(n,this)))},__onInputChange:function(t,e){return!1===t.validate?(this.state.value=null,!1):(t.formitem=this,this.state.value=t.value,!1!==(this.props.onChange&&this.props.onChange(t,e,this))&&(this.props.onInputChange&&this.props.onInputChange(t,e,this)))},__onInputEnter:function(t,e){return!1===t.validate?(this.state.value=null,!1):(t.formitem=this,!1!==(this.props.onEnter&&this.props.onEnter(t,e,this))&&(this.state.value=t.value,void(this.props.onInputEnter&&this.props.onInputEnter(t,e,this))))},__renderHeader:function(){return s.createElement("div",{className:"zrfi-header"},this.props.icon&&s.createElement("span",{className:"icon"},s.createElement("i",{className:"fa "+this.props.icon})),this.props.label&&s.createElement("div",{className:"title"},this.props.label))},__valueRender:function(t){return t.type,s.createElement("span",{className:"item-value"},t.text||t.value)},__renderBody:function(){var t=zn.extend({},this.props,this.props.inputProps,{className:znui.react.classname("body-input",this.props.inputClassName),value:this.state.value,text:this.state.text,onChange:this.__onInputChange,onEnter:this.__onInputEnter}),e=this.props.input;e&&"function"==typeof e&&!e.prototype.isReactComponent&&(e=e.call(this.props.context||null,this,t));var n=znui.react.createReactElement(e,t,this.props.context);return s.createElement("div",{className:"zrfi-body","data-zr-popup-tooltip":this.state.errorMessage},n,this.props.suffix&&s.createElement("span",{className:"suffix"},this.props.suffix))},__renderContent:function(){var t=zn.extend({},this.props,{className:znui.react.classname("render",this.props.renderClassName),value:this.state.value,text:this.state.text,onChange:this.__onInputChange,onEnter:this.__onInputEnter}),e=this.props.render;e&&"function"==typeof e&&!e.prototype.isReactComponent&&(e=e.call(null,this,t));var n=znui.react.createReactElement(e,t);return n||s.createElement(s.Fragment,null,this.__renderHeader(),this.__renderBody(),!!this.props.hint&&s.createElement("div",{className:"zrfi-hint"},s.createElement("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"info-circle",className:"info-icon svg-inline--fa fa-info-circle fa-w-16 ",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},s.createElement("path",{fill:"currentColor",d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"})),this.props.hint))},render:function(){return s.createElement("div",{style:this.props.style,className:znui.react.classname("zr-form-item",this.props.className),"data-disabled":this.props.disabled,"data-required":this.props.required,"data-layout":this.props.layout,"data-size":this.props.size,"data-status":this.state.status},this.__renderContent())}});t.exports=r},function(module,exports,__webpack_require__){function _extends(){return _extends=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},_extends.apply(null,arguments)}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperty(t,e,n){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var s=n.call(t,e||"default");if("object"!=_typeof(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var React=znui.React||__webpack_require__(0),FormItem=__webpack_require__(1),FormGroup=__webpack_require__(3),FormButtons=__webpack_require__(4),popup=__webpack_require__(6);module.exports=React.createClass({displayName:"ZRAjaxForm",getDefaultProps:function(){return{disabled:!1,action:null,method:"post",encType:"multipart/form-data",buttons:[{value:"取消",type:"cancel",icon:"fa-times"},{value:"提交",type:"submit",icon:"fa-edit"}]}},getInitialState:function(){return _defineProperty(_defineProperty(_defineProperty({validateErrorMessage:null,submitting:!1,hiddens:{},value:{}},"value",zn.extend({},this.props.value)),"data",[]),"refs",{})},componentDidMount:function(){this.props.onDidMount&&this.props.onDidMount(this)},componentWillUnmount:function(){},cancel:function(){this.props.onCancel&&this.props.onCancel(this)},reset:function(){this.setState({submitting:!1,hiddens:{}});var t=this.refs,e=null;for(var n in t)(e=t[n])&&e.reset();return this},__onReset:function(){this.props.onReset&&this.props.onReset()},getValue:function(t){var e=this.validate(t);if(!e)return!1;if(e=zn.extend(e,this.state.hiddens),e=zn.extend(e,this.props.hiddens),this.props.merge){var n={};n[this.props.merge]=e,e=n}return zn.extend(e,this.props.exts),e},__isApiValue:function(t){return!(!t||"object"!=_typeof(t)||!t.__api__)},setValue:function(t,e){if(!t)return this;if(this.__isApiValue(t)&&this.state.value)return this.state.value.call(t,e),this;if(zn.is(t,"object")){for(var n in this.state.hiddens)this.state.hiddens[n]=t[n]||this.state.hiddens[n];var s=this.refs,r=null,i=null,a=null;for(var n in s)(r=s[n])&&(i=t[n],a=t[n+"_convert"],null!==i&&r.setValue(i,a))}return this},submit:function(t,e){var n=this.getValue();if(!n)return!1;var s=this.props.onSubmitBefore&&this.props.onSubmitBefore(n,this,e);if(!1===s)return!1;n=s||n;var r=zn.extend({url:this.props.action,method:this.props.method},this.props.submitApi),i="get"==(this.props.method||r.method||"post").toLocaleLowerCase()?"params":"data";if(r[i]||(r[i]={}),zn.extend(r[i],n),!r.url||!r[i])return!1;this.state.submit?this.state.submit.call(r,t):this.state.submit=zn.data.create(r,{before:function(t,e){this.__isMounted&&this.setState({submitting:!0}),this.props.onSubmiting&&this.props.onSubmiting(e,this)}.bind(this),after:function(t,e){this.__isMounted&&this.setState({submitting:!1}),this.props.onSubmited&&this.props.onSubmited(e,this)}.bind(this),success:function(t,e){200==e.code?this.props.onSubmitSuccess&&this.props.onSubmitSuccess(e.result,this):this.props.onSubmitError&&this.props.onSubmitError(e,this)}.bind(this),error:function(t,e){this.props.onSubmitError&&this.props.onSubmitError(e,this)}.bind(this)},this.props.context)},__submit__:function(t,e){this.submit(null,t)},__onSubmit:function(){if(!1===(this.props.onSubmit&&this.props.onSubmit()))return!1},validate:function(t){var e=this.state.refs,n=null,s={},r=null,i=null;for(var a in e)if(i=(n=e[a]).props.valueKey||a,n&&i&&n.props.name&&n.props.submitted&&!1!==n.props.editable){if(n.props.required&&n.validate&&null==(r=n.validate(t)))return!1;if(n.getValue&&(r=n.getValue(t)),n.props.required&&null==r)return!1;null!=r&&(s[i]=r)}return s},__parseItemValue:function __parseItemValue(value){return 0==value.indexOf("javascript:")?eval(value):value},__onItemInputChange:function(t,e,n){return t.validateValue=n.validate(),this.props.onInputChange&&this.props.onInputChange(t,e,n,this)},__onValidateError:function(t,e){this.setState({validateErrorMessage:"输入框 “"+e.props.label+"” "+t})},__onValidateSuccess:function(){this.setState({validateErrorMessage:null})},__itemRender:function(t,e){var n=this;if("ZRHidden"==t.type)return this.state.hiddens[t.name]=null!=t.value?this.__parseItemValue(t.value):null,null;if(t.input&&("zr.form.FormTitle"==t.input||"ZRFormTitle"==t.input.displayName))return"string"==typeof t.input&&(t.input=zn.path(window,t.input)),React.createElement(t.input,_extends({key:e},t));var s=t.name,r=this.state.value||{},i=r[s],a=r[s+"_convert"];return null==i&&null!=t.value&&(i=t.value),null==a&&null!=t.text&&(a=t.text),React.createElement(FormItem,_extends({context:this.props.context},t,{key:e,ref:function(t){s&&(n.state.refs[s]=t)},value:i,text:a,index:e,form:this,onValidateError:this.__onValidateError,onValidateSuccess:this.__onValidateSuccess,onInputChange:t.onInputChange||this.__onItemInputChange,onInputEnter:t.onInputEnter||this.submit}))},__renderPropsData:function(){var t=this.props.data;return zn.is(t,"function")&&(t=t.call(null,this)),React.createElement(FormGroup,{data:t,itemRender:this.__itemRender,responseHandler:this.props.responseHandler})},__renderStateData:function(){var t=this.state.data;return zn.is(t,"function")&&(t=t.call(null,this)),React.createElement(FormGroup,{data:t,itemRender:this.__itemRender,responseHandler:this.props.responseHandler})},__renderGroups:function(){var t=this;return this.props.groups?React.createElement("div",{className:"groups"},this.props.groups.map((function(e){return React.createElement(FormGroup,_extends({},e,{itemRender:t.__itemRender,responseHandler:t.props.responseHandler}))}))):null},__renderButtons:function(){return this.props.buttons?React.createElement(FormButtons,{data:this.props.buttons,onSubmit:this.__submit__,onReset:this.reset,onCancel:this.cancel}):null},__onValueLoading:function(t){this.setState({submitting:!0}),this.props.onValueLoading&&this.props.onValueLoading(t,this)},__onValueLoaded:function(t){this.setState({value:t,submitting:!1}),this.props.onValueLoaded&&this.props.onValueLoaded(t,this)},__onValueLoadError:function(t){this.setState({submitting:!1}),this.props.onValueLoadError&&this.props.onValueLoadError(t),popup.notifier.error("Error: "+t.message)},__renderValidateError:function(){if(this.state.validateErrorMessage)return React.createElement("div",{className:"zr-form-validate-error"},React.createElement("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"times",className:"svg-inline--fa fa-times fa-w-11 ",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 352 512"},React.createElement("path",{fill:"currentColor",d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"})),React.createElement("span",null,this.state.validateErrorMessage))},__render:function(){return React.createElement("div",{style:znui.react.style(this.props.style),className:znui.react.classname("zr-form zr-ajax-form",this.props.className)},this.__renderPropsData(),this.__renderStateData(),this.__renderGroups(),this.__renderValidateError(),this.__renderButtons(),this.state.submitting&&React.createElement("div",{className:"zr-form-loader"},React.createElement("span",{className:"loader"}),React.createElement("span",{className:"text"},"提交中 ... ")),this.props.disabled&&React.createElement("div",{className:"zr-form-disabled"}))},__loadingRender:function(){return React.createElement("div",{style:znui.react.style(this.props.style),className:znui.react.classname("zr-form zr-ajax-form",this.props.className)},React.createElement("div",{className:"zr-form-loader"},React.createElement("span",{className:"loader"}),React.createElement("span",{className:"text"},"Loading ... ")))},render:function(){var t=this;return this.state.hiddens={},this.__isApiValue(this.props.value)?React.createElement(znui.react.DataLifecycle,{data:this.props.value,loadingRender:this.__loadingRender,onLoading:this.__onValueLoading,onFinished:this.__onValueLoaded,onError:this.__onValueLoadError,onDataCreated:function(e){return t.state.value=e},dataRender:this.__render}):(this.props.value&&"object"==_typeof(this.props.value)&&(this.state.value=this.props.value),this.__render())}})},function(t,e,n){function s(){return s=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},s.apply(null,arguments)}var r=znui.React||n(0),i=n(1),a=n(8),o=n(6);t.exports=r.createClass({displayName:"ZRFormGroup",getInitialState:function(){return{loading:!0}},__itemRender:function(t,e){var n=this.props.itemRender&&this.props.itemRender(t,e);return null===n&&(n=r.createElement(i,s({},t,{key:e}))),n},__onLoading:function(){this.setState({loading:!0})},__onFinished:function(){this.setState({loading:!1})},__onError:function(t){this.setState({loading:!1}),o.notifier.error("Error: "+t.message)},render:function(){return r.createElement("div",{className:znui.react.classname("zr-form-group",this.props.className),style:znui.react.style(this.props.style)},r.createElement(znui.react.DataView,s({},this.props,{itemRender:this.__itemRender,onLoading:this.__onLoading,onFinished:this.__onFinished,onError:this.__onError})),this.state.loading&&r.createElement(a.Loader,{content:"...",loader:"circle",size:"size-smail",layout:"flex-row"}))}})},function(t,e,n){function s(){return s=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},s.apply(null,arguments)}var r=znui.React||n(0),i=n(9);t.exports=r.createClass({displayName:"ZRFormButtons",__buttonClick:function(t,e){switch(t.data.type){case"reset":this.props.onReset&&this.props.onReset(t,e);break;case"submit":this.props.onSubmit&&this.props.onSubmit(t,e);break;case"cancel":this.props.onCancel&&this.props.onCancel(t,e);break;default:this.props.onClick&&this.props.onClick(t,e)}},render:function(){return r.createElement(i.Buttons,s({},this.props,{className:znui.react.classname("zr-form-buttons",this.props.className),style:this.props.style,onClick:this.__buttonClick}))}})},function(t,e,n){function s(){return s=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},s.apply(null,arguments)}var r=znui.React||n(0),i=znui.ReactDOM||n(11),a=n(1),o=n(3),u=n(4);t.exports=r.createClass({displayName:"ZRNativeForm",getDefaultProps:function(){return{action:null,autoComplete:"off",method:"post",name:null,noValidate:null,target:"_self",encType:"multipart/form-data"}},getInitialState:function(){return{submitting:!1,value:{}}},componentDidMount:function(){this.__initValue()},__initValue:function(){var t=this.props.value;t&&(t.__api__?this.__initApiValue(t):this.__initObjectValue(t))},__initApiValue:function(t){var e=this.props.events||{},n=e.before,s=e.after;this.state.data=zn.data.create(t,zn.extend(e,{before:function(t,e){this.setState({submitting:!0}),this.props.onValueLoading&&this.props.onValueLoading(e,this),n&&n(t,e)}.bind(this),after:function(t,e){this.setState({submitting:!1,value:e}),this.props.onValueFinished&&this.props.onValueFinished(e,this),s&&s(t,e)}.bind(this)}),this.props.context)},__initObjectValue:function(t){this.props.onValueLoading&&this.props.onValueLoading(t,this),this.setState({value:t}),this.props.onValueFinished&&this.props.onValueFinished(t,this)},cancel:function(){},reset:function(){this.setState({submitting:!1,value:{}}),i.findDOMNode(this).reset()},__onReset:function(){this.props.onReset&&this.props.onReset()},submit:function(t,e){this.setState({submitting:!0})},__onSubmit:function(t){if(!1===(this.props.onSubmit&&this.props.onSubmit(t,this)))return!1},validate:function(){},__onItemChange:function(){this.props.onItemChange&&this.props.onItemChange()},__onItemInputChange:function(){this.props.onItemInputChange&&this.props.onItemInputChange()},__itemRender:function(t,e){return r.createElement(a,s({key:e},t,{value:this.state.value[t.name],text:this.state.value[t.name+"_convert"],onChange:this.__onItemChange,onInputChange:this.__onItemInputChange}))},__renderItems:function(){return r.createElement(o,{data:this.props.data,itemRender:this.__itemRender})},__renderGroups:function(){var t=this.props.groups||[];return t.length?r.createElement("div",{className:"groups"},t.map(function(t){return r.createElement(o,s({},t,{itemRender:this.__itemRender}))}.bind(this))):null},__renderButtons:function(){return this.props.buttons?r.createElement(u,{data:this.props.buttons,onSubmit:this.submit,onReset:this.reset,onCancel:this.cancel}):null},render:function(){var t=this.props.hiddens||{};return r.createElement("form",{style:znui.react.style(this.props.style),className:znui.react.classname("zr-form zr-native-form",this.props.className),action:this.props.action,autoComplete:this.props.autoComplete,method:this.props.method,name:this.props.name,noValidate:this.props.noValidate,target:this.props.target,encType:this.props.encType,onReset:this.__onReset,onSubmit:this.__onSubmit},Object.keys(t).map((function(e,n){return r.createElement("input",{key:"hidden_"+e,type:"hidden",name:e,value:t[e]})})),this.__renderItems(),this.__renderGroups(),this.__renderButtons(),this.state.submitting&&r.createElement("div",{className:"zr-form-loader"},r.createElement("span",{className:"loader"}),r.createElement("span",{className:"text"},"Submitting ...")))}})},function(t,e){!function(){t.exports=this.popup}()},function(t,e,n){t.exports={AjaxForm:n(2),Form:n(10),FormButtons:n(4),FormGroup:n(3),FormItem:n(1),FormItems:n(12),FormItemValue:n(13),FormTitle:n(14),FormPanel:n(15),NativeForm:n(5),Label:n(16),Hint:n(17)}},function(t,e){!function(){t.exports=this.loader}()},function(t,e){!function(){t.exports=this.button}()},function(t,e,n){var s=znui.React||n(0),r=n(2),i=n(5);t.exports=s.createClass({displayName:"ZRForm",render:function(){return"Native"==this.props.type?s.createElement(i,this.props):s.createElement(r,this.props)}})},function(t,e){!function(){t.exports=this.ReactDOM}()},function(t,e,n){var s=znui.React||n(0);t.exports=s.createClass({displayName:"ZRFormItems",__render:function(){},render:function(){return s.createElement("div",{className:znui.react.classname("zr-form-item-value",this.props.className),style:this.props.style},this.props.data.map((function(){})))}})},function(t,e,n){var s=znui.React||n(0);t.exports=s.createClass({displayName:"ZRFormItemValue",__render:function(){this.props.type},render:function(){return s.createElement("div",{className:znui.react.classname("zr-form-item-value",this.props.className),style:this.props.style},this.__render())}})},function(t,e,n){var s=znui.React||n(0);t.exports=s.createClass({displayName:"ZRFormTitle",render:function(){return s.createElement("div",{className:znui.react.classname("zr-form-title",this.props.className),style:this.props.style},s.createElement("span",{className:"zf-title"},this.props.label))}})},function(t,e,n){var s=znui.React||n(0),r=n(2),i=n(5);t.exports=s.createClass({displayName:"ZRFormPanel",__render:function(){return"Native"==this.props.type?s.createElement(i,this.props):s.createElement(r,this.props)},__renderTitle:function(){return this.props.titleRender&&this.props.titleRender()||this.props.title},render:function(){var t=this.__renderTitle();return s.createElement("div",{className:znui.react.classname("zr-form-panel",this.props.className),style:this.props.style},!!t&&s.createElement("div",{className:"panel-title"},this.props.title),s.createElement("div",{className:"panel-content"},this.__render()))}})},function(t,e,n){var s=znui.React||n(0);t.exports=s.createClass({displayName:"ZRLabel",render:function(){var t=this.props.text||this.props.value;return s.createElement("div",{className:znui.react.classname("zr-form-item-label",this.props.className),style:this.props.style},s.createElement("div",{className:"label",dangerouslySetInnerHTML:{__html:t}}))}})},function(t,e,n){var s=znui.React||n(0);t.exports=s.createClass({displayName:"ZRHint",render:function(){var t=this.props.value||this.props.text;return s.createElement("div",{className:znui.react.classname("zr-form-item-hint",this.props.className),style:this.props.style},!!this.props.title&&s.createElement("div",{className:"hint-title"},this.props.title),!!t&&s.createElement("div",{className:"hint-value",dangerouslySetInnerHTML:{__html:t}}))}})}]));